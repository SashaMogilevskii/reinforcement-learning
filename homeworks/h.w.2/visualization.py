import time
import random

import torch
import gym
import numpy as np

from torch import nn
from tqdm import tqdm


def set_seed(seed=1771):
    random.seed(seed)
    np.random.seed(seed)
    torch.manual_seed(seed)
    torch.cuda.manual_seed(seed)
    torch.backends.cudnn.deterministic = False
    torch.backends.cudnn.benchmark = True



env = gym.make("MountainCarContinuous-v0")
env.seed(1771)



state = env.reset()


lst_action = [1.0, 1.0, 0.24947428059397914, -0.10504185531934085, -0.10240454555977274, 0.6530796728373217, 1.0, 0.7941116625878117, 0.48281041145587583, -0.022856616174166677, 1.0, 1.0, 0.93302738676016, 0.8363120296116242, 0.9436455900259244, 0.41361737790090636, 0.9786743154584157, 0.6707281862841142, 0.4464891496154113, 1.0, 0.7650413567538317, 1.0, 0.682952056325435, 0.8196968975589666, 1.0, 1.0, 1.0, 1.0, -0.024609923444980475, 1.0, -0.013414492863476957, 1.0, -0.5654850977721668, 1.0, 0.9313933286668565, 0.9000717623343586, -0.9589002563364988, 0.4486194176888868, 1.0, 0.4740574639694405, 1.0, 0.4846321331641747, 1.0, 1.0, 0.31055253591452625, 0.6681522524475232, 0.7084284248796123, 0.8013486713041794, 1.0, 1.0, 0.915420308988673, 1.0, 1.0, 1.0, 0.5777141163395116, 1.0, 0.8452100508705613, 0.18469637048422938, 1.0, 0.6955656675404392, 0.9210070378735226, -0.03620058204158427, 0.708858738253613, 0.49252594031408015, 1.0, 0.9150529040724026, 1.0, 1.0, -1.0, 1.0, 0.9101572734633961, 1.0, 0.952940057848373, 1.0, 0.6635504507140533, 1.0, 1.0, 0.9693923694430923, 0.43370159105122935, 1.0, 0.8287947496013301, 1.0, 1.0, 1.0, 0.9309512289429941, 0.9945684070715521, -0.1766661203959512, 1.0, 1.0, 1.0, 1.0, 1.0, -0.025499995214391058, 0.8683048349092717, 0.6486684541754003, 1.0, 0.42027214344365094, 0.8496034381794199, 0.6709694900076941, -0.17618285826309288, 0.812688895076649, 0.1732616940659778, 0.22371260448451624, 0.9470249096785829, 0.1097712326415573, 1.0, 1.0, 0.8614076853470187, 0.6541361766642798, 1.0, 1.0, 0.6929975741970912, -0.1249126747819479, 1.0, 0.9716260644040998, 1.0, 1.0, 0.5902500267882259, 1.0, 1.0, 1.0, 0.16696060132928614, 1.0, -0.01392899217533139, 0.1450657121868495, 0.21085332396742107, 0.2983727743291549, 1.0, 1.0, 0.8405659200098208, 1.0, 1.0, 0.2813535447766078, 0.5242080902658014, 0.7274019965945233, -0.22572983186464635, 0.19425785394820083, 0.6919139076272114, 1.0, 1.0, 1.0, 0.6936072437678403, 0.5917482805038912, 1.0, 1.0, 1.0, 0.8015127750457136, 1.0, 1.0, 0.5714684322006884, 0.8139484585531975, 0.592750740306523, 1.0, 1.0, 0.7626823416172399, 1.0, 0.6013182830049333, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.3128479217292077, 0.5176712988613239, 0.5617810612749471, 0.5732150953631743, 1.0, 0.6184747915479804, 1.0, 0.9810734542120557, 0.5283358248882096, 1.0, 1.0, -0.004795434665034737, 1.0, 0.7371584949949846, 0.9413508517884527, -0.02289745616961758, 0.2159829371527454, 0.07084085264153173, 0.21059878768768414, 0.43128328077557415, 1.0, 1.0, 0.8660670533732118, 0.3775138303320899, 1.0, 1.0, 0.44101565508080026, 1.0, -0.0266462683749199, 1.0, 0.09455804454964134, 0.13124416092541236, 0.6618281855806274, 0.6085583880862901, 1.0, 0.5523226589076411, 0.6911357827904515, 0.5962677032498971, 0.7413738016814786, 1.0, -0.6168564813596975, 1.0, 1.0, -1.0, 0.9839576797481588, 1.0, 0.18101523435663436, 1.0, 1.0, 0.529682079337601, 1.0, 0.531309931931782, 1.0, -0.24409328853089862, 0.12558316435356687, -0.4687249627936072, 0.9670370113476159, 0.6840000821222051, 1.0, 0.6334510171545049, 0.5042077348235459, 0.18066339441399315, 1.0, 0.774803717522356, 0.961407819628353, 1.0, 1.0, 0.6431233281769234, 1.0, 0.6122373759855093, 1.0, 1.0, 0.7347802807561805, 0.4440020483316068, 0.3925348695583541, 1.0, 0.9939288876255647, -0.3669482721136528, 1.0, 0.734054079181614, 0.22546960070545619, -0.0679153116341421, 1.0, 0.28610565093186824, 1.0, 0.026616377786459977, 0.8689912007418817, -0.033156989802371806, 0.7196019289090021, 0.7996953596955638, 1.0, 1.0, 0.3429584493839144, 1.0, 0.8436566946646562, 0.6317391672015628, 0.8299153075846002, 0.7051890991731788, 0.7668621184689944, 0.9006902054621125, 1.0, -0.203684736368692, 0.0967101744154979, 1.0, 0.43938325842561465, 0.14503888735735793, 0.4557231159964081, 1.0, 1.0, 0.5737522911537098, 1.0, 0.6357026446827476, 1.0, 0.7509791229791175, 0.1963154107423586, 1.0, 0.5399469774652321, 1.0, 0.7414708010133507, 0.08056275183818995, 0.7644048584123645, 0.4270601909960896, 1.0, 0.8897382169355519, -0.08130201443511942, 0.9966808583247269, 0.15418419814079076, 0.43496467475404604, 1.0, 0.696771519776017, 1.0, 0.45215237782150447, 1.0, 0.6130482259349761, 1.0, 0.5612999758385995, 0.5162456421256738, 0.5271304455853176, 0.565740893488164, 1.0, 0.9822815531194308, 0.45634702999850224, 1.0, 1.0, 1.0, 1.0, 1.0, -0.10714375495942974, 1.0, 1.0, 1.0, 1.0, 1.0, -0.07438642346853819, 0.8430802164171831, 0.9746487007158087, 1.0, 1.0, 0.5152501303949384, 1.0, 1.0, -0.004987500226019015, 1.0, 0.4644557371565162, 1.0, 0.07316435742143879, 1.0, -0.09959121507209767, 0.44102967832537315, 0.4841456383597347, 1.0, 1.0, 1.0, 0.20249995298354584, 0.9231258220142686, 0.7220423948102671, 0.41405648733182565, 1.0, 1.0, 1.0, -0.4308787637945921, -0.6402963537897233, 0.13121152396236058, 1.0, 1.0, 1.0, 0.7638034272854255, 1.0, 0.008110540321893178, 0.6600209721539625, 0.787875106323342, 0.9255010977578304, 1.0, 1.0, 0.08056809198864656, 1.0, 1.0, 0.49680616987505044, 0.943958306808949, 1.0, 0.708412837100019, 1.0, 0.2413989084053456, 1.0, 1.0, 1.0, 1.0, 1.0, 0.5551301762262685, -0.23284051027663333, 1.0, 1.0, 0.45944057752399603, 1.0, 0.1705966996638021, 0.4245080622547399, 1.0, 1.0, 0.5641479062286344, 1.0, 0.7237719005128818, 0.4899186766655496, 0.9156908452997581, 1.0, 0.9890998734122399, 1.0, 1.0, 0.10922847472165553, 0.32483259848083557, 1.0, 1.0, 1.0, 1.0, 0.9036196435795888, 1.0, 1.0, 1.0, -0.16071332998558052, 0.44194636407992893, 0.4771252609826786, 1.0, -0.20578719039036675, 0.5963408890339126, -0.19037555446704846, 0.8955434600481116, 0.0416837957301881, 0.3484543597494584, 1.0, 1.0, 1.0, 1.0, 0.4384554147827205, 0.47355727983506857, -0.06311651069814472, -0.2695019519951707, 1.0, 1.0, 0.005266576769405118, 1.0, 0.018288705989031095, 0.37572067963699524, 0.5842986466379128, 0.9718649678988767, -0.158428152530385, 1.0, 1.0, 1.0, 0.9116041675666046, 1.0, 1.0, 0.6124468041255917, 1.0, 1.0, 0.6096826286323402, 0.1606002984661432, 1.0, 0.9057549050192213, 0.905888872126646, -0.10962959716974086, 0.06343715711306441, 0.4850275155186442, 0.9940435441336454, 1.0, 0.7467252693868849, 0.32942225977728534, 0.6733947857513812, 1.0, 1.0, 1.0, 0.4892226530029875, 1.0, 0.48560582128575214, 1.0, 1.0, -0.04633630704215075, 1.0, 1.0, 0.8734083906780168, 1.0, 0.5428477419559352, 0.9926372050529164, 0.5525047490267931, 0.6957959895979045, 1.0, 1.0, 0.3387610749058595, 0.6201273140600689, 1.0, 0.3403772611045034, 0.8128192555495785, 1.0, -0.012553072134589116, 0.8410786732702872, 1.0, 1.0, 0.72473178096808, 0.705584014943164, 1.0, 0.69641421319115, 0.25355098756444916, 0.3809932616337638, 1.0, 1.0, 0.0074285430899300176, 0.6399346350810824, 0.9144803891317738, -0.6752503844198021, 0.9730983392126642, 0.7634203329586965, 0.7806965452878761, 0.4040624182207784, 1.0, -0.08432978079354037, 0.5807645265320149, -0.1642675330465675, 1.0, 1.0, 0.918699837936414, 1.0, 1.0, 1.0, 0.9968657756357149, 0.0901067921706038, 1.0, 1.0, 0.6128333157552462, 1.0, 0.5344754368308939, 0.6733646409805132, 1.0, -0.4056003640302901, 1.0, 1.0, -0.060417859204136226, 0.9782742110982394, 1.0, -0.540450656233546, 0.7374635155548267, 0.9189694623149187, 0.3348208422272103, 1.0, 0.4908836125388808, 1.0, 0.054015300026563184, 1.0, 0.7585349128307063, 1.0, 0.3173649757041406, 1.0, 1.0, 1.0, 0.5568712194226121, 1.0, 1.0, -0.0375039415126831, 0.5097373913656689, 0.7318599504323977, 0.5341152928260733, 0.8208731196305128, 0.005573234997300336, 0.9471286304116651, 1.0, 0.6887325117467482, 0.8293621575377925, 0.8143817189305688, 0.27477295200978635, 0.7858936645811483, 1.0, 1.0, 1.0, 0.1254051531048418, 0.15019243019741946, 0.7674024514518815, 1.0, 0.9354047897850121, 0.2910564076283719, 1.0, 1.0, 1.0, 1.0, 0.6460920451032255, -0.3530381416456927, 0.5490431086790261, 1.0, 0.5392453010932757, -0.4972482821136619, 0.07412194123677063, 0.9096449314472665, 0.6759291033645742, 0.1660461387673453, 0.4371092299015956, -0.06303026725585503, 0.957148255470075, -0.11981804382377526, 1.0, -0.2027281166986763, 1.0, 1.0, 0.6428953636204824, 1.0, 1.0, 1.0, 1.0, 0.8922418757478511, -0.21222815048667987, 1.0, 0.5628840915303577, 1.0, 0.962059916256763, 1.0, 1.0, 0.8479980086828031, 0.16473673357164464, 0.35257948429124586, 1.0, 0.9641216134467526, 1.0, 1.0, 0.6702159901975854, 0.5560884226710492, 1.0, 1.0, 1.0, 0.8758869113702207, 1.0, 0.20290943494283376, 0.2181807093719016, 1.0, 0.26626935841008936, 0.6888550744114268, 1.0, 1.0, -0.28359795408439337, 1.0, 1.0, 0.552775468467081, 1.0, 1.0, 1.0, 1.0, 0.4570400833919889, 0.4094363570468808, 0.7261521080671419, 0.6740419653708408, 1.0, 0.9367613420618718, 0.5337741268975861, 0.30731009849418733, 1.0, 0.6188918436247485, 1.0, 0.13270316449146902, 1.0, 1.0, 0.9697199316695125, 0.8236915438659294, 0.4486137519908371, 1.0, 0.5287324176004634, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.07906730688386332, -0.17337803422296316, 1.0, 0.3035699491806506, 1.0, 1.0, -0.04872871288506997, -0.3934882227685472, 0.7973292535799111, 0.7057062576921853, 0.06218920830425434, 1.0, -0.7589781437982195, 0.47199110478495054, -0.1426818558701224, 0.78499094206605, 0.4959637911200058, 0.8626012729717187, 1.0, -0.09139958617582, 0.8722112728678008, 1.0, 1.0, 0.6933333887016426, 0.24541119619649276, 1.0, 0.7454117759591794, 0.7925812059244787, 1.0, 1.0, 1.0, -0.4605180630714574, 1.0, 1.0, 0.2634664768880073, 1.0, 0.6282481722919745, 0.9559247662180128, 1.0, 1.0, 0.585742921327874, 0.3183974055129307, 1.0, 1.0, 1.0, 0.34511825079517433, 1.0, 0.44156133710321965, 0.08759861087631049, 0.18489690749906396, 0.6218477868226915, 1.0, 0.9677956370038827, -0.5717467015597697, -0.1310622540479387, 0.9836707106326605, 1.0, 1.0, 0.12652351117693594, 0.7105274379818727, 0.6295371507192538, 1.0, 1.0, 0.8070217285450523, -0.004903057627417828, 0.517729418924097, 1.0, -0.6241450385098644, 0.0717033120725844, 0.38015731033625844, 1.0, 1.0, 0.9263220602547064, 1.0, 1.0, 0.2896287252884152, 1.0, 0.6924529527091217, 1.0, 0.9250863434208387, 1.0, 1.0, 1.0, 0.19636223337722636, 0.7853247010186076, 0.8451980486023866, 0.9162295484076557, 1.0, 0.4128330859653314, 0.4853991966175242, 0.990655591254817, 1.0, 1.0, 1.0, 0.6570076605442446, 0.1733092744963931, 0.13918168302828993, 1.0, 1.0, 0.8881850964253578, -0.4295138556776237, 0.6442247101794677, -0.15401505949288197, 1.0, -0.06061753654008084, -0.013793899236086316, 0.8994208993781402, 0.2671878182142956, 1.0, 0.7803741536965652, 0.8276757975641023, 1.0, 1.0, 0.5886563431124612, -0.11345183144970838, 0.6083609137053552, 0.9551550517394385, 0.9043968229232408, 0.4285366658792817, 1.0, 0.9193615147021539, -0.17104922334848838, 0.5702051170063186, 0.6846026899738437, 1.0, 1.0, 0.6882126605715431, 0.4288627726969658, 1.0, 1.0, 0.4513083267804618, 1.0, 0.5893774553613502, 1.0, 0.7747602247979153, 0.9199507156166296, 1.0, 1.0, 0.49067806680557263, 1.0, 1.0, 1.0, 1.0, -0.08174577501444924, 1.0, 1.0, 0.6479855889059448, 1.0, 0.9538085188197163, 1.0, 0.8351769474209542, 1.0, 0.9913772963060767, 0.30272381079586164, -0.02653731593805264, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.8532718329203306, -0.42659143001463073, 0.5867124534290181, 1.0, 0.15921489587735593, 1.0, 1.0, 0.9711910463918709, 1.0, 1.0, 1.0, 0.2945386092679121, 0.04971506920084534, -0.12931938969849488, 0.9104189371952458, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9915949798179606, 0.3951083772361195, 1.0, 0.4746228602155217, 0.29775075289658615, 0.6634548504517734, 1.0, 0.355654757206572, 0.6868823328369651, 0.8000708374404305, -0.6601986173416237, -0.27200604291488384, 0.45270864952830037, 1.0, 0.7362719421738757, 1.0, 1.0, 1.0, 0.572929804515466, 0.7088658587243759, 0.7566720438889671, 1.0, 0.4370739973225075, 1.0, 0.9663659221884223, -0.07148010382016434, 0.35788385691974645, 0.8376940734931699, 0.5797494005779058, 0.86914301046224, 1.0, -0.6261211518384648, -0.23399617393854633, 0.2517220073562344, 1.0, 0.24408528406102414, 0.7855676921839114, 0.8501276600916576, 1.0, 0.9413072667366505, -0.04513476738947397, 1.0, 0.37875554232048203, 1.0, 1.0, 0.8717312087986102, 1.0, 0.3251856280708093, 0.9870240789958096, 0.5450085524123931, 0.7970595632046965, 1.0, 1.0, 0.7848659676300541, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.1912238261070368, 1.0, 1.0, 1.0, 0.5942070404740569, -0.12739419906708116, 1.0, 0.26924752585331113, 1.0, 1.0, 1.0, 0.5080573303944049, 1.0, 1.0, 0.5713410607775633, 0.8006260163728545, 0.4622419967095292, 1.0, 1.0, 0.527861359873514, 0.5620214471011202, 1.0, 0.7165345124195546, 0.8234137102864796, 0.7719292515402132, 1.0, 1.0, 0.4925377571000867]
print(len(lst_action))
for action in lst_action:
    state, reward, done, _ = env.step(np.array([action]))

    print(done)
    if done == True:
        break
    time.sleep(0.005)
    env.render()
